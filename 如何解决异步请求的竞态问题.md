# 如何解决异步请求的竞态问题

> 疫情期间 大家带好口罩 ^ . ^

<img src="https://github.com/YuArtian/blog/blob/master/img/%E6%8F%92%E5%9B%BE/WechatIMG161.jpeg?raw=true" style="width:300px" />

## 引子

这大概是所有前端在实际工作中都要解决的问题吧。。。

在现在的交互场景中，搜索框里的实时下拉提示，地图缩放时的数据更新等等。。

只要你多次触发同一个动作 多次调用了同一个接口，你就要考虑时序的问题

这次所讨论的内容并不是给请求加`loading`的判断啊，或者节流啊防抖啊，或者 `async/await`啊之类的

因为在下面的场景中这些并不能解决问题。。

请注意，我们的接口响应时间是随机的，而且我们要得到最新的结果，也就是最后一个请求得到的响应

## 场景描述

现在页面上有一个输入框，随着用户的输入会不断发出异步请求，取回后端返回的结果渲染在页面上。

但是蛋疼的是，接口的响应时间并不确定，也就是说，有可能先请求的后返回，后请求的却先返回了。

如果不作处理，这会导致前端渲染的结果错误（不是最后一个请求返回的结果）

那么。。如何才能保证页面正确的渲染呢？

## 重现

我们可以先简单重现一下，领会一下精神，代码如下，效果如图







